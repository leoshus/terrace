(function(a){a.extend(a.ui.dialog.prototype,{initMinMaxRestore:function(){var b=this,c=b.options;b._isMax=false;b._isMin=false;uiDialogTitlebarMaxRestore=a('<a href="#"></a>').addClass("ui-dialog-titlebar-max ui-corner-all").attr("role","button").hover(function(){uiDialogTitlebarMaxRestore.addClass("ui-state-hover")},function(){uiDialogTitlebarMaxRestore.removeClass("ui-state-hover")}).focus(function(){uiDialogTitlebarMaxRestore.addClass("ui-state-focus")}).blur(function(){uiDialogTitlebarMaxRestore.removeClass("ui-state-focus")}).click(function(d){if(b._isMax||b._isMin){b.restore(d)}else{b.maximize(d)}return false}).appendTo(b.uiDialogTitlebar);b.uiDialogTitlebar.dblclick(function(d){uiDialogTitlebarMaxRestore.trigger("click");return false});uiDialogTitlebarMaxRestoreText=(b.uiDialogTitlebarMaxRestoreText=a("<span></span>")).addClass("ui-icon ui-icon-extlink").text("Max").appendTo(uiDialogTitlebarMaxRestore);uiDialogTitlebarMin=(b.uiDialogTitlebarMin=a('<a href="#"></a>')).addClass("ui-dialog-titlebar-min ui-corner-all").attr("role","button").hover(function(){uiDialogTitlebarMin.addClass("ui-state-hover")},function(){uiDialogTitlebarMin.removeClass("ui-state-hover")}).focus(function(){uiDialogTitlebarMin.addClass("ui-state-focus")}).blur(function(){uiDialogTitlebarMin.removeClass("ui-state-focus")}).click(function(d){b.minimize(d);return false}).appendTo(b.uiDialogTitlebar);uiDialogTitlebarMinText=(b.uiDialogTitlebarMinText=a("<span></span>")).addClass("ui-icon ui-icon ui-icon-minusthick").text("Min").appendTo(uiDialogTitlebarMin)},maximize:function(){var b=this,c=b.options;b.positionBeforeMinMax=b.uiDialog.position();b.heightBeforeMinMax=b.uiDialog.height();b.widthBeforeMinMax=b.uiDialog.width();marginHDialog=3;marginWDialog=12;marginHDialog=a(window).height()-marginHDialog;marginWDialog=a("body").width()-marginWDialog;b.uiDialog.css({position:"absolute",bottom:"auto",left:0,top:0});c.width=marginWDialog;c.height=marginHDialog;b._size();b.uiDialogTitlebarMin.show();b.uiDialogTitlebarMaxRestoreText.addClass("ui-icon-newwin").removeClass("ui-icon-extlink").text("Restore");b._isMax=true;if(c.maxCallback){c.maxCallback(b.uiDialog)}},minimize:function(){var b=this,c=b.options;b.positionBeforeMinMax=b.uiDialog.position();b.heightBeforeMinMax=b.uiDialog.height();b.widthBeforeMinMax=b.uiDialog.width();b.uiDialog.css({position:"absolute",top:"auto",left:10,width:250,height:30,bottom:0});b.uiDialog.css("position","fixed");b.uiDialogTitlebarMin.hide();b._isMin=true;if(c.minCallback){c.minCallback(b.uiDialog)}},restore:function(){var b=this,c=b.options;b.uiDialog.css({position:"absolute",bottom:"auto",left:b.positionBeforeMinMax.left,top:b.positionBeforeMinMax.top});c.height=b.heightBeforeMinMax;c.width=b.widthBeforeMinMax;b._size();b.uiDialogTitlebarMin.show();b.uiDialogTitlebarMaxRestoreText.addClass("ui-icon-extlink").removeClass("ui-icon-newwin").text("Max");b._isMax=false;b._isMin=false;if(c.restoreCallback){c.restoreCallback(b.uiDialog)}},reload:function(d){var b=this,c=b.options;if(d){a.each(d,function(e,f){c.url=AddOrReplaceUrlParameter(c.url,e,f)})}load(c.url)}});a.popupDialog=function(j){a.assertNotBlank(j.url);var h=a(window).height()-20-14;var d=a("body").width()-20;var g=function(k){k.find("div[id^='gbox_'].ui-jqgrid").each(function(){var l=a(this).parent().width();if(l){a("#"+a(this).attr("id").substr(5)).setGridWidth(l-2)}})};var e={dialogId:"editDialog",modal:false,autoOpen:false,width:d,height:h,heightStyle:"fill",minHeight:30,title:"Popup Dialog",initOpenMax:false,resizeStop:function(k,l){g(a("#"+b.dialogId))},beforeClose:function(k,l){var m=false;a("#"+b.dialogId).find("form").each(function(){if(a(this).attr("_needTrackChang")=="true"){if(a(this).attr("_inputChanged")=="true"){m=true}}});if(m){return confirm("当前窗口有未提交的修改表单数据,是否确认关闭?")}},maxCallback:function(k){g(k)},restoreCallback:function(k){g(k)}};var b=jQuery.extend(e,j);var i=b.dialogId;var c=a("#"+i);if(c.length<=0){a("body").append("<div id='"+i+"' style='width:100%;overflow-x:hidden;'></div>");c=a("#"+i);c.dialog(b);c.dialog("initMinMaxRestore")}var f=c.attr("_url");if(f==undefined||b.url!=f){c.dialog("option","title",b.title);if(b.width){c.dialog("option","width",b.width)}if(b.height){c.dialog("option","height",b.height)}c.load(b.url,function(){if(b.callback){b.callback()}})}c.css("overflow-y","scroll");c.attr("_url",b.url);c.dialog("open");if(b.initOpenMax){c.dialog("maximize")}};a.popupViewDialog=function(b){a.popupDialog({dialogId:"viewDialog_"+new Date().getTime(),url:b,title:"数据查看"})}})(jQuery);